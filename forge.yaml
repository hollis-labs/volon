version: 1

project:
  id: auto
  name: forge

storage:
  backend: nanite
  files:
    root: ".forge/tasks"
  nanite:
    vault: forge          # vault name to push to; null = use nanite's active vault
    tag_prefix: "forge/"
    default_priority: "B"

observability:
  verbosity: verbose
  write_run_log: true
  write_decision_log: true
  redact_secrets: true
  log_dir: ".forge/logs"

git:
  use_worktrees: true
  worktree_root: ".worktrees"
  branch_prefix: "forge/"
  pr_mode: optional
  pr:
    base_branch: auto
    title_prefix: "forge:"
    body_template: ".forge/templates/pr-body.md"

pcc:
  enabled: true
  location: ".forge/pcc"
  global_dir: "global"        # L0: project-wide invariants → .forge/pcc/global/
  tasks_dir: "tasks"          # L2: task resume capsules   → .forge/pcc/tasks/
  commit_to_git: true
  refresh:
    on_workflow_start: true
    on_git_change: true
    scheduled: false
  limits:
    max_files: 25
    max_section_words: 400

workflows:
  new_feature:
    enabled: true
    defaults:
      track_tasks: true
      require_spec: true
  new_app:
    enabled: false
  update_docs:
    enabled: true
  quality_loop:
    enabled: true
    cadence_days: 14

bootstrap:
  enabled: true
  path: .forge/bootstrap.md
  history_path: .forge/bootstrap/history
  max_tasks_per_run: 6
  completion_token: DONE

quality:
  modes: [dead_code, security, correctness, perf_smells]
  on_issue:
    default_action: create_task

prompt_generator:
  default_role: orchestrator      # always orchestrator; non-negotiable
  commit_policy: iteration        # iteration | task
  pr_mode: optional               # off | optional | required
  subagents_enabled: false        # false = single writer only; true = read-only, max 2/run
  verbosity: standard             # standard | verbose | minimal
